# Backend - Парсеры тендеров

Бэкенд для парсинга тендеров из различных источников, включая hanked.ee для строительных тендеров и бетонных работ.

## Установка

### 1. Установите Python 3.8+

```bash
python --version
```

### 2. Установите зависимости

```bash
cd backend
pip install -r requirements.txt
```

### 3. Настройте переменные окружения

Скопируйте `.env.example` в `.env` и заполните настройки:

```bash
cp .env.example .env
```

Отредактируйте `.env` файл с вашими настройками.

## Использование

### Запуск парсера hanked.ee вручную

```bash
cd backend
python parsers/hanked_parser.py
```

Результаты будут сохранены в файл `hanked_tenders.json`.

### Запуск планировщика (автоматический парсинг)

```bash
python scheduler.py
```

Парсер будет запускаться автоматически каждые 30 минут (настраивается в `.env`).

## Структура

```
backend/
├── parsers/
│   ├── __init__.py
│   └── hanked_parser.py      # Парсер для hanked.ee
├── config.py                 # Конфигурация
├── scheduler.py              # Планировщик задач
├── requirements.txt          # Зависимости Python
├── .env.example             # Пример конфигурации
└── README.md                # Документация
```

## Парсер hanked.ee

### Функции

- **Поиск тендеров** по ключевым словам (бетон, бетонные работы, фундамент и т.д.)
- **Фильтрация** по категории "Бетонные работы"
- **Извлечение деталей** тендеров (название, описание, сумма, сроки, документы)
- **Автоматическое определение** региона и категории

### Ключевые слова для поиска

Парсер автоматически ищет тендеры по следующим ключевым словам:
- бетон, betoon, concrete
- бетонные работы, betoonitööd
- фундамент, vundament
- заливка бетона, betooni valamine
- бетонирование, betoonimine
- железобетон, raudbetoon

### Пример использования

```python
from parsers.hanked_parser import HankedParser

# Создание парсера
parser = HankedParser(delay=2.0)

# Поиск тендеров
tenders = parser.search_tenders(
    keywords=['бетон', 'бетонные работы'],
    max_pages=3
)

# Фильтрация по бетонным работам
concrete_tenders = parser.filter_concrete_tenders(tenders)

# Получение деталей тендера
for tender in concrete_tenders:
    details = parser.get_tender_details(tender['url'])
    print(details)
```

## Настройка

### Интервал парсинга

В файле `.env` можно настроить:
- `PARSER_DELAY` - задержка между запросами (секунды)
- `MAX_PAGES` - максимальное количество страниц для парсинга
- `HANKED_SCHEDULE` - расписание запуска (cron формат)

### Регионы

По умолчанию парсер ищет тендеры в регионах:
- Таллинн
- Тарту
- Нарва
- Пярну

Можно настроить в `config.py`.

## Интеграция с фронтендом

После парсинга данные можно:
1. Сохранить в базу данных PostgreSQL
2. Отправить в очередь Redis/RabbitMQ
3. Предоставить через REST API

## Следующие шаги

1. ✅ Парсер hanked.ee создан
2. ⏳ Настроить сохранение в базу данных
3. ⏳ Создать REST API для фронтенда
4. ⏳ Настроить уведомления при найденных тендерах
5. ⏳ Добавить парсеры для других источников

## Примечания

- Парсер использует задержки между запросами для избежания блокировок
- Рекомендуется использовать прокси при большом количестве запросов
- Проверьте условия использования сайта hanked.ee перед использованием парсера
